---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Contact Us">
	<main>
		<h1>Contact Us</h1>
		<p class="intro">Have a question or feedback? Send us a message and we'll get back to you.</p>

		<form id="contact-form">
			<div class="field">
				<label for="name">Name</label>
				<input type="text" id="name" name="name" required autocomplete="name" />
			</div>

			<div class="field">
				<label for="email">Email</label>
				<input type="email" id="email" name="email" required autocomplete="email" />
			</div>

			<div class="field">
				<label for="message">Message</label>
				<textarea id="message" name="message" rows="5" required></textarea>
			</div>

			<button type="submit">Send Message</button>
		</form>

		<p id="form-status" class="status" aria-live="polite"></p>
	</main>
</Layout>

<script>
	const form = document.getElementById('contact-form') as HTMLFormElement;
	const status = document.getElementById('form-status') as HTMLParagraphElement;
	const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;

	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		submitBtn.disabled = true;
		submitBtn.textContent = 'Sendingâ€¦';
		status.textContent = '';
		status.className = 'status';

		try {
			const res = await fetch('/api/contact', {
				method: 'POST',
				body: new FormData(form),
			});

			const data = await res.json();

			if (res.ok) {
				status.textContent = 'Message sent. We\'ll get back to you soon.';
				status.className = 'status success';
				form.reset();
			} else {
				status.textContent = data.error || 'Something went wrong. Please try again.';
				status.className = 'status error';
			}
		} catch {
			status.textContent = 'Something went wrong. Please try again.';
			status.className = 'status error';
		}

		submitBtn.disabled = false;
		submitBtn.textContent = 'Send Message';
	});
</script>

<style>
	main {
		max-width: 40rem;
		margin: 0 auto;
		padding: var(--space-12) var(--space-4);
	}

	h1 {
		font-size: var(--text-4xl);
		margin-bottom: var(--space-2);
	}

	.intro {
		font-size: var(--text-lg);
		color: var(--color-text-muted);
		line-height: 1.6;
		margin-bottom: var(--space-8);
	}

	form {
		display: flex;
		flex-direction: column;
	}

	.field {
		margin-bottom: var(--space-6);
	}

	label {
		display: block;
		font-size: var(--text-sm);
		font-weight: 600;
		color: var(--color-text);
		margin-bottom: var(--space-2);
	}

	input,
	textarea {
		width: 100%;
		box-sizing: border-box;
		padding: var(--space-3);
		font-size: var(--text-base);
		font-family: inherit;
		color: var(--color-text);
		background: var(--color-bg);
		border: 1px solid var(--color-border);
		border-radius: 0.375rem;
	}

	input:focus,
	textarea:focus {
		outline: none;
		border-color: var(--color-primary);
		box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
	}

	textarea {
		resize: vertical;
	}

	button[type='submit'] {
		align-self: flex-start;
		padding: var(--space-3) var(--space-6);
		font-size: var(--text-base);
		font-family: inherit;
		font-weight: 600;
		color: #ffffff;
		background: var(--color-primary);
		border: none;
		border-radius: 0.375rem;
		cursor: pointer;
	}

	button[type='submit']:hover:not(:disabled) {
		background: var(--color-primary-hover);
	}

	button[type='submit']:disabled {
		opacity: 0.6;
		cursor: not-allowed;
	}

	.status {
		margin-top: var(--space-4);
		font-size: var(--text-sm);
		min-height: 1.25rem;
	}

	.status.success {
		color: var(--color-success);
	}

	.status.error {
		color: var(--color-error);
	}
</style>
